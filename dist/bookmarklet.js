!function(){"use strict";function e(){const e=window.location.pathname;for(const[t,o]of Object.entries(s))if(e.includes(o.url))return t;return null}function t(){if(!r)return;const e=s[r];e.filterFn&&n.querySelectorAll("#indexScreen tbody tr:not(.dontanimate)").forEach(t=>{t.style.display=e.filterFn(t,i)?"":"none"})}function o(){const e=Array.from(document.querySelectorAll('button[title="Auto load entries"]')).find(e=>e.classList.contains("active"));e&&(e.click(),console.log("Disabled auto-load button"));let t=0;!function e(){const o=Array.from(document.querySelectorAll("a")).filter(e=>"Load Older Entries"===e.textContent.trim()),n=o[o.length-1];n?(n.click(),console.log(`Clicked ${t+1}/100`)):console.log(`Button not found, retrying... (${t+1}/100)`),t++,100>t?setTimeout(e,300):console.log("Completed 100 steps.")}()}const n=document;let l=null,r=null,i={};const s={requests:{name:"Requests",url:"/telescope/requests",filters:[{type:"select",id:"method",label:"Method",options:["ALL","GET","POST","PUT","PATCH","DELETE"]},{type:"text",id:"status",label:"Status",placeholder:"e.g. 200, 404"},{type:"duration",id:"duration",label:"Duration (ms)",placeholder:"e.g. 1000"},{type:"text",id:"path",label:"Path Contains",placeholder:"e.g. /api/v1/users"}],filterFn:(e,t)=>{const o=e.querySelector(".badge"),n=e.querySelectorAll("td")[2]?.querySelector(".badge"),l=e.querySelectorAll("td")[3]?.querySelector("span"),r=e.querySelectorAll("td")[1];if(!(o&&r&&n&&l))return!0;const i=o.textContent.trim(),s=n.textContent.trim(),a=l.textContent.trim(),d=r.getAttribute("title")||r.textContent.trim(),c=parseInt(a.replace("ms","")),u=!t.method||"ALL"===t.method||i===t.method,p=!t.status||s.includes(t.status),m=!t.duration||c>=parseInt(t.duration),f=!t.path||d.toLowerCase().includes(t.path.toLowerCase());return u&&p&&m&&f}},"client-requests":{name:"HTTP Client",url:"/telescope/client-requests",filters:[{type:"select",id:"method",label:"Method",options:["ALL","GET","POST","PUT","PATCH","DELETE"]},{type:"text",id:"status",label:"Status",placeholder:"e.g. 200, 404"},{type:"duration",id:"duration",label:"Duration (ms)",placeholder:"e.g. 1000"},{type:"text",id:"uri",label:"URI Contains",placeholder:"e.g. api/models"}],filterFn:(e,t)=>{const o=e.querySelector(".badge"),n=e.querySelectorAll("td")[2]?.querySelector(".badge"),l=e.querySelectorAll("td")[3]?.querySelector("span"),r=e.querySelectorAll("td")[1];if(!o||!r||!n)return!0;const i=o.textContent.trim(),s=n.textContent.trim(),a=r.getAttribute("title")||r.textContent.trim(),d=l?l.textContent.trim():"0ms",c=parseInt(d.replace("ms",""))||0,u=!t.method||"ALL"===t.method||i===t.method,p=!t.status||s.includes(t.status),m=!t.duration||c>=parseInt(t.duration),f=!t.uri||a.toLowerCase().includes(t.uri.toLowerCase());return u&&p&&m&&f}},jobs:{name:"Jobs",url:"/telescope/jobs",filters:[{type:"text",id:"jobName",label:"Job Name",placeholder:"e.g. SendEmailJob"},{type:"text",id:"status",label:"Status",placeholder:"e.g. pending, completed"},{type:"text",id:"connection",label:"Connection",placeholder:"e.g. redis"},{type:"text",id:"queue",label:"Queue",placeholder:"e.g. default"}],filterFn:(e,t)=>{const o=e.querySelector("td span[title]"),n=e.querySelectorAll("td")[1]?.querySelector(".badge"),l=e.querySelector("td small.text-muted");if(!o||!n)return!0;const r=o.getAttribute("title")||o.textContent.trim(),i=n.textContent.trim(),s=l?l.textContent.trim():"",a=!t.jobName||r.toLowerCase().includes(t.jobName.toLowerCase()),d=!t.status||i.toLowerCase().includes(t.status.toLowerCase()),c=!t.connection||s.toLowerCase().includes(t.connection.toLowerCase()),u=!t.queue||s.toLowerCase().includes(t.queue.toLowerCase());return a&&d&&c&&u}},cache:{name:"Cache",url:"/telescope/cache",filters:[{type:"text",id:"key",label:"Key Contains",placeholder:"e.g. user_"},{type:"text",id:"action",label:"Action",placeholder:"e.g. hit, missed, set"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector(".badge");if(!o||!n)return!0;const l=o.textContent.trim(),r=n.textContent.trim(),i=!t.key||l.toLowerCase().includes(t.key.toLowerCase()),s=!t.action||r.toLowerCase().includes(t.action.toLowerCase());return i&&s}},queries:{name:"Queries",url:"/telescope/queries",filters:[{type:"text",id:"query",label:"Query Contains",placeholder:"e.g. SELECT, users"},{type:"duration",id:"duration",label:"Duration (ms)",placeholder:"e.g. 100"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector("span");if(!o)return!0;const l=o.textContent.trim(),r=n?n.textContent.trim():"0ms",i=parseInt(r.replace("ms",""))||0,s=!t.query||l.toLowerCase().includes(t.query.toLowerCase()),a=!t.duration||i>=parseInt(t.duration);return s&&a}},events:{name:"Events",url:"/telescope/events",filters:[{type:"text",id:"name",label:"Event Name",placeholder:"e.g. UserRegistered"},{type:"text",id:"listeners",label:"Listeners",placeholder:"e.g. SendWelcomeEmail"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1];if(!o)return!0;const l=o.textContent.trim(),r=n?n.textContent.trim():"",i=!t.name||l.toLowerCase().includes(t.name.toLowerCase()),s=!t.listeners||r.toLowerCase().includes(t.listeners.toLowerCase());return i&&s}},gates:{name:"Gates",url:"/telescope/gates",filters:[{type:"text",id:"ability",label:"Ability",placeholder:"e.g. update-post"},{type:"text",id:"result",label:"Result",placeholder:"e.g. allowed, denied"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector(".badge");if(!o||!n)return!0;const l=o.textContent.trim(),r=n.textContent.trim(),i=!t.ability||l.toLowerCase().includes(t.ability.toLowerCase()),s=!t.result||r.toLowerCase().includes(t.result.toLowerCase());return i&&s}},logs:{name:"Logs",url:"/telescope/logs",filters:[{type:"text",id:"message",label:"Message Contains",placeholder:"e.g. error, user"},{type:"text",id:"level",label:"Level",placeholder:"e.g. error, warning, info"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector(".badge");if(!o||!n)return!0;const l=o.textContent.trim(),r=n.textContent.trim(),i=!t.message||l.toLowerCase().includes(t.message.toLowerCase()),s=!t.level||r.toLowerCase().includes(t.level.toLowerCase());return i&&s}},models:{name:"Models",url:"/telescope/models",filters:[{type:"text",id:"model",label:"Model",placeholder:"e.g. User, Post"},{type:"text",id:"action",label:"Action",placeholder:"e.g. created, updated"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector(".badge");if(!o||!n)return!0;const l=o.textContent.trim(),r=n.textContent.trim(),i=!t.model||l.toLowerCase().includes(t.model.toLowerCase()),s=!t.action||r.toLowerCase().includes(t.action.toLowerCase());return i&&s}},redis:{name:"Redis",url:"/telescope/redis",filters:[{type:"text",id:"command",label:"Command",placeholder:"e.g. GET, SET"},{type:"duration",id:"duration",label:"Duration (ms)",placeholder:"e.g. 10"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1]?.querySelector("span");if(!o)return!0;const l=o.textContent.trim(),r=n?n.textContent.trim():"0ms",i=parseInt(r.replace("ms",""))||0,s=!t.command||l.toLowerCase().includes(t.command.toLowerCase()),a=!t.duration||i>=parseInt(t.duration);return s&&a}},views:{name:"Views",url:"/telescope/views",filters:[{type:"text",id:"name",label:"View Name",placeholder:"e.g. welcome, dashboard"},{type:"text",id:"composers",label:"Composers",placeholder:"e.g. ProfileComposer"}],filterFn:(e,t)=>{const o=e.querySelectorAll("td")[0],n=e.querySelectorAll("td")[1];if(!o)return!0;const l=o.textContent.trim(),r=n?n.textContent.trim():"",i=!t.name||l.toLowerCase().includes(t.name.toLowerCase()),s=!t.composers||r.toLowerCase().includes(t.composers.toLowerCase());return i&&s}},commands:{name:"Commands",url:"/telescope/commands",todo:!0},schedule:{name:"Schedule",url:"/telescope/schedule",todo:!0},batches:{name:"Batches",url:"/telescope/batches",todo:!0},exceptions:{name:"Exceptions",url:"/telescope/exceptions",todo:!0},mail:{name:"Mail",url:"/telescope/mail",todo:!0},notifications:{name:"Notifications",url:"/telescope/notifications",todo:!0},dumps:{name:"Dumps",url:"/telescope/dumps",todo:!0}};!function a(){const d=n.getElementById("tfContainer");if(d&&(l&&clearInterval(l),l=null,d.remove()),r=e(),!r)return void alert("Telescope Filter: Unknown page type");const c=s[r],u=n.createElement("div");if(u.id="tfContainer",u.innerHTML=function(e){const t=s[e];let o="";if(t.todo)o='\n        <div style="text-align:center;padding:40px 20px;color:#9ca3af">\n          <p style="font-size:48px;margin:0 0 10px">ðŸš§</p>\n          <p style="font-size:14px;margin:0">TODO: Filters not yet implemented</p>\n          <p style="font-size:12px;margin:10px 0 0;color:#6b7280">This page type will be supported in a future update</p>\n        </div>\n      ';else{const e=t.filters.map(e=>function(e){const t="width:100%;padding:8px;border:1px solid #374151;border-radius:4px;font-size:13px;box-sizing:border-box;background:#111827;color:#f9fafb";if("select"===e.type){const o=e.options.map(e=>`<option value="${e}">${e}</option>`).join("");return`\n        <div style="margin-bottom:12px">\n          <label style="display:block;margin-bottom:5px;font-weight:600;color:#9ca3af;font-size:13px">${e.label}:</label>\n          <select id="tf_${e.id}" style="${t}">${o}</select>\n        </div>\n      `}return"duration"===e.type?`\n        <div style="margin-bottom:12px">\n          <label style="display:block;margin-bottom:5px;font-weight:600;color:#9ca3af;font-size:13px">${e.label}:</label>\n          <div style="display:flex;gap:8px">\n            <input type="text" id="tf_${e.id}" placeholder="${e.placeholder}" style="flex:1;padding:8px;border:1px solid #374151;border-radius:4px;font-size:13px;box-sizing:border-box;background:#111827;color:#f9fafb">\n            <button id="tf_${e.id}_inc" style="padding:8px 12px;background:#f59e0b;color:#fff;border:none;border-radius:4px;cursor:pointer;font-weight:600;font-size:13px">+1sec</button>\n          </div>\n        </div>\n      `:`\n        <div style="margin-bottom:12px">\n          <label style="display:block;margin-bottom:5px;font-weight:600;color:#9ca3af;font-size:13px">${e.label}:</label>\n          <input type="text" id="tf_${e.id}" placeholder="${e.placeholder}" style="${t}">\n        </div>\n      `}(e)).join("");o=`\n        <h3 style="margin:0 0 15px;color:#f9fafb;font-size:16px">Filter ${t.name}</h3>\n        ${e}\n        <div style="display:flex;gap:8px;margin-bottom:8px">\n          <button id="tfFilter" style="flex:1;padding:8px;background:#3b82f6;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:600;font-size:13px">Apply</button>\n          <button id="tfReset" style="flex:1;padding:8px;background:#6b7280;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:600;font-size:13px">Reset</button>\n        </div>\n      `}return`\n      <div id="tfDialog" style="position:fixed;top:20px;right:20px;background:#1f2937;padding:20px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,0.5);z-index:10000;width:280px;font-family:sans-serif;border:1px solid #374151">\n        <div style="margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #374151">\n          <h2 id="tfActiveTab" style="margin:0;color:#3b82f6;font-size:16px;font-weight:600;text-align:center">${t.name}</h2>\n        </div>\n\n        <div id="tfContent">${o}</div>\n\n        <button id="tfLoadMore" style="width:100%;padding:8px;background:#10b981;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:600;font-size:13px;margin-bottom:8px">Load More</button>\n        <button id="tfClose" style="width:100%;padding:8px;background:#ef4444;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:600;font-size:13px;margin-bottom:12px">Close</button>\n\n        <div style="text-align:center;padding-top:8px;border-top:1px solid #374151">\n          <a href="https://github.com/Antons-S/laravel-telescope-filter" target="_blank" style="color:#9ca3af;font-size:11px;text-decoration:none">Latest version on GitHub</a>\n        </div>\n      </div>\n    `}(r),n.body.appendChild(u),c.todo)return n.getElementById("tfLoadMore").onclick=o,void(n.getElementById("tfClose").onclick=()=>{l&&clearInterval(l),u.remove()});const p={};c.filters.forEach(e=>{const t=n.getElementById("tf_"+e.id);if(t){if(p[e.id]=t,"duration"===e.type){const o=n.getElementById(`tf_${e.id}_inc`);o&&(o.onclick=()=>{const e=parseInt(t.value)||0;t.value=e+1e3})}t.onkeypress=e=>{"Enter"===e.key&&n.getElementById("tfFilter").click()}}}),n.getElementById("tfFilter").onclick=()=>{i={},c.filters.forEach(e=>{const t=p[e.id];t&&(i[e.id]=t.value)}),l&&clearInterval(l),l=setInterval(t,500),t()},n.getElementById("tfReset").onclick=()=>{l&&clearInterval(l),l=null,i={},c.filters.forEach(e=>{const t=p[e.id];t&&(t.value="select"===e.type?e.options[0]:"")}),t()},n.getElementById("tfLoadMore").onclick=o,n.getElementById("tfClose").onclick=()=>{l&&clearInterval(l),u.remove()};let m=location.pathname;setInterval(()=>{location.pathname!==m&&(m=location.pathname,e()!==r&&(l&&clearInterval(l),u.remove(),setTimeout(a,100)))},500)}()}();